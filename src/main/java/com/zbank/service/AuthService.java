package com.zbank.service;import com.zbank.entity.User;import com.zbank.repository.UserRepository;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;import org.springframework.stereotype.Service;import java.util.Optional;@Servicepublic class AuthService {    @Autowired    private UserRepository userRepository;    @Autowired    private BCryptPasswordEncoder passwordEncoder;    public User registerUser(String username, String password) {        if (userRepository.findByUsername(username).isPresent()) {            throw new RuntimeException("Username already exists");        }        User user = new User();        user.setUsername(username);        user.setPasswordHash(passwordEncoder.encode(password));        return userRepository.save(user);    }    public Optional<User> loginUser(String username, String password) {        Optional<User> userOptional = userRepository.findByUsername(username);        if (userOptional.isPresent()) {            User user = userOptional.get();            if (passwordEncoder.matches(password, user.getPasswordHash())) {                return Optional.of(user);            }        }        return Optional.empty();    }}